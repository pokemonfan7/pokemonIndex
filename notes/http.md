## TCP传输的三次握手四次挥手策略
`SYN`同步标志、`ACK`确认标志、`FIN`结束标志

### 三次握手建立连接
为了准确无误地把数据送达目标处，`TCP`协议采用了三次握手策略。  
用`TCP`协议把数据包送出去后，`TCP`不会对传送后的情况置之不理，它一定会向对方确认是否成功送达。握手过程中使用了`TCP`的标志：`SYN`和`ACK`。  
发送端首先发送一个带`SYN`标志的数据包给对方。接收端收到后，回传一个带有`SYN/ACK`标志的数据包以示传达确认信息。  
最后，发送端再回传一个带`ACK`标志的数据包，代表“握手”结束。  
若在握手过程中某个阶段莫名中断，`TCP`协议会再次以相同的顺序发送相同的数据包。

### 四次挥手断开连接
- 第一次挥手：主动关闭方发送一个`FIN`，用来关闭主动方到被动关闭方的数据传送，也就是主动关闭方告诉被动关闭方：我已经不会再给你发数据了(当然，在`FIN`包之前发送出去的数据，如果没有收到对应的`ACK`确认报文，主动关闭方依然会重发这些数据)，但是，此时主动关闭方还可以接受数据。
- 第二次挥手：被动关闭方收到`FIN`包后，发送一个`ACK`给对方，确认序号为收到序号+1（与`SYN`相同，一个`FIN`占用一个序号）。
- 第三次挥手：被动关闭方发送一个`FIN`，用来关闭被动关闭方到主动关闭方的数据传送，也就是告诉主动关闭方，我的数据也发送完了，不会再给你发数据了。
- 第四次挥手：主动关闭方收到`FIN`后，发送一个`ACK`给被动关闭方，确认序号为收到序号+1，至此，完成四次挥手。

## HTTP头信息控制缓存
强制缓存：200 from cache  
Expires：描述的是一个绝对时间，因为服务器时间和客户端时间可能存在差异，所以使用较少  
Cache-control：描述的是一个相对时间，在进行缓存命中的时候，都是利用客户端时间进行判断，管理更有效，安全一些 Cache-Control: max-age=3600  
协商缓存：304 not modified  
Last-Modified/If-Modified-Since：标示这个响应资源的最后修改时间。Last-Modified是服务器相应给客户端的，If-Modified-Sinces是客户端发给服务器，服务器判断这个缓存时间是否是最新的，是的话拿缓存。  
Etag/If-None-Match：Etag和Last-Modified类似，他是发送一个字符串来标识版本。

### 总结
- 浏览器端缓存分为200 from cache和304 not modified
- HTTP协议中Cache-Control 和 Expires可以用来设置新鲜度的限值，前者是HTTP1.1中新增的响应头，后者是HTTP1.0中的响应头
- Cache-Control设置max-age（单位为s），而Expires指定的是具体的过期日期而不是秒数
- Cache-Control和Expires同时使用的话，Cache-Control会覆盖Expires
- 客户端不用关心ETag值如何产生，只要服务在资源状态发生变更的情况下将ETag值发送给它就行
- ETag常与If-None-Match或者If-Match一起，由客户端通过HTTP头信息(包括ETag值)发送给服务端处理。
- Last-Modified常与If-Modified-Since一起由客户端将Last-Modified值包括在HTTP头信息中发给服务端进行处理。
- 有些文档资源周期性的被重写，但实际内容没有改变。此时文件元数据中会显示文件最近的修改日期与If-Modified-Since不相同，导致不必要的响应。

## Etag
聪明的服务器开发者会把ETags和GET请求的“If-None-Match”头一起使用，这样可利用客户端（例如浏览器）的缓存。  
因为服务器首先产生ETag，服务器可在稍后使用它来判断页面是否已经被修改。  
本质上，客户端通过将该记号传回服务器要求服务器验证其（客户端）缓存。  
其过程如下：  
客户端请求一个页面（A）。  
服务器返回页面A，并在给A加上一个ETag。  
客户端展现该页面，并将页面连同ETag一起缓存。  
客户再次请求页面A，并将上次请求时服务器返回的ETag一起传递给服务器。  
服务器检查该ETag，并判断出该页面自上次客户端请求之后还未被修改，直接返回响应304（未修改——Not Modified）和一个空的响应体。  

## CDN的基本原理
广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。


